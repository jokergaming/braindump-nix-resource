#+TITLE: Nix Deploy
#+AUTHOR: GuangTao
#+EMAIL: gtrunsec@hardenedlinux.org
#+DATE: 2021-01-20 Wed 15:13


#+OPTIONS:   H:3 num:t toc:t \n:nil @:t ::t |:t ^:nil -:t f:t *:t <:t

- tags :: [[file:guangtao_nix.org][GuangTao's Nix]]

* Nix Deployments
:PROPERTIES:
:ID:       63902fbf-3333-4a66-bd7a-85aff74cd739
:END:
 - [2021-01-22 Fri 00:52] -> [[id:73ffce07-74fb-447e-8472-73d2a96e102a][Nix Use Cases]]
* Nix Deploy Services
:PROPERTIES:
:ID:       741e72b2-cd10-4cfc-b4a5-ad6f60b32614
:END:
 - [2021-01-20 Wed 15:14] -> [[id:c773e0e9-27ef-470a-8038-87633989e2da][Deploy Nix Binary Server]]
* Nix Docker Deployment
** [[https://github.com/barrucadu/nixfiles/blob/master/hosts/dreamlands/configuration.nix][nixfiles/configuration.nix at master Â· barrucadu/nixfiles]]
* [[https://github.com/datakurre/nomad-with-nix][datakurre/nomad-with-nix: Example of developing and deploying services with Nix and Nomad]]



  #+begin_src nix :exports both :results output
deploy.nodes = (digga.lib.mkDeployNodes self.nixosConfigurations {
  # if config.networking.hostName == <extraConfig.hostname> then <merge extraConfig.hostname.attrs> else {}
  "hostname-1<NixOS>" = {
    hostname = "10.220.170.112"; #overrding hostname and without modifing the hosts file
    sshUser = "root";
    fastConnection = true;
    sshOpts = [ "-p" "25" ];
  };
  "hostname-<devos-1>" = {
    sshOpts = [ "-p" "17788" ];
    hostname = "10.110.110.1"
  };
});
  #+end_src
